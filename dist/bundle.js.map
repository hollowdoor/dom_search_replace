{"version":3,"file":null,"sources":["../src/index.js"],"sourcesContent":["import domSearch from 'dom-search';\nimport isRegexp from 'is-regexp';\n\n\nfunction domSearchReplace(doc, pattern, replacement, options){\n    const search = typeof options === 'object' ?  Object.create(options) : {};\n    search.type = getPatternType(pattern);\n\n    let result = domSearch(doc, pattern, options);\n\n    if(!result.length){\n        return doc;\n    }\n\n    if(result.length === 1){\n        replaceNode(result[0], pattern, replacement, search);\n    }else{\n        replaceNodes(result, pattern, replacement, search);\n    }\n\n    return doc;\n}\n\nfunction replaceNode(result, pattern, replacement, search){\n    let str = result.textNode.nodeValue;\n\n    if(search.type === 'string'){\n        let start = str.indexOf(pattern);\n        let end = start + pattern.length;\n        let before = str.slice(0, start);\n        let after = str.slice(end, str.length);\n\n        if(typeof replacement === 'string'){\n            result.textNode.nodeValue = before + replacement + after;\n        }else{\n            const frag = document.createDocumentFragment();\n            frag.appendChild(document.createTextNode(before));\n            frag.appendChild(replacement);\n            frag.appendChild(document.createTextNode(after));\n            result.parent.replaceChild(frag, result.textNode);\n        }\n\n    }else if(search.type === 'regexp'){\n        result.textNode.nodeValue = str.replace(pattern, replacement);\n    }\n}\n\nfunction replaceNodes(result, pattern, replacement, search){\n    for(let info of result){\n        replaceNode(info, pattern, replacement, search);\n    }\n}\n\nfunction getPatternType(pattern){\n    if(isRegexp(pattern)){\n        return 'regexp';\n    }\n\n    return typeof pattern;\n}\n\nexport default domSearchReplace;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAIA,SAAS,gBAAT,CAA0B,GAA1B,EAA+B,OAA/B,EAAwC,WAAxC,EAAqD,OAArD,EAA6D;QACnD,SAAS,QAAO,OAAP,yCAAO,OAAP,OAAmB,QAAnB,GAA+B,OAAO,MAAP,CAAc,OAAd,CAA/B,GAAwD,EAAvE;WACO,IAAP,GAAc,eAAe,OAAf,CAAd;;QAEI,SAAS,UAAU,GAAV,EAAe,OAAf,EAAwB,OAAxB,CAAb;;QAEG,CAAC,OAAO,MAAX,EAAkB;eACP,GAAP;;;QAGD,OAAO,MAAP,KAAkB,CAArB,EAAuB;oBACP,OAAO,CAAP,CAAZ,EAAuB,OAAvB,EAAgC,WAAhC,EAA6C,MAA7C;KADJ,MAEK;qBACY,MAAb,EAAqB,OAArB,EAA8B,WAA9B,EAA2C,MAA3C;;;WAGG,GAAP;;;AAGJ,SAAS,WAAT,CAAqB,MAArB,EAA6B,OAA7B,EAAsC,WAAtC,EAAmD,MAAnD,EAA0D;QAClD,MAAM,OAAO,QAAP,CAAgB,SAA1B;;QAEG,OAAO,IAAP,KAAgB,QAAnB,EAA4B;YACpB,QAAQ,IAAI,OAAJ,CAAY,OAAZ,CAAZ;YACI,MAAM,QAAQ,QAAQ,MAA1B;YACI,SAAS,IAAI,KAAJ,CAAU,CAAV,EAAa,KAAb,CAAb;YACI,QAAQ,IAAI,KAAJ,CAAU,GAAV,EAAe,IAAI,MAAnB,CAAZ;;YAEG,OAAO,WAAP,KAAuB,QAA1B,EAAmC;mBACxB,QAAP,CAAgB,SAAhB,GAA4B,SAAS,WAAT,GAAuB,KAAnD;SADJ,MAEK;gBACK,OAAO,SAAS,sBAAT,EAAb;iBACK,WAAL,CAAiB,SAAS,cAAT,CAAwB,MAAxB,CAAjB;iBACK,WAAL,CAAiB,WAAjB;iBACK,WAAL,CAAiB,SAAS,cAAT,CAAwB,KAAxB,CAAjB;mBACO,MAAP,CAAc,YAAd,CAA2B,IAA3B,EAAiC,OAAO,QAAxC;;KAbR,MAgBM,IAAG,OAAO,IAAP,KAAgB,QAAnB,EAA4B;eACvB,QAAP,CAAgB,SAAhB,GAA4B,IAAI,OAAJ,CAAY,OAAZ,EAAqB,WAArB,CAA5B;;;;AAIR,SAAS,YAAT,CAAsB,MAAtB,EAA8B,OAA9B,EAAuC,WAAvC,EAAoD,MAApD,EAA2D;;;;;;6BACvC,MAAhB,8HAAuB;gBAAf,IAAe;;wBACP,IAAZ,EAAkB,OAAlB,EAA2B,WAA3B,EAAwC,MAAxC;;;;;;;;;;;;;;;;;;AAIR,SAAS,cAAT,CAAwB,OAAxB,EAAgC;QACzB,SAAS,OAAT,CAAH,EAAqB;eACV,QAAP;;;kBAGU,OAAd,yCAAc,OAAd;CAGJ;;"}