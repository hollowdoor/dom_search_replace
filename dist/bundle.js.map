{"version":3,"file":null,"sources":["../src/index.js"],"sourcesContent":["import domSearch from 'dom-search';\n\nfunction domSearchReplace(doc, pattern, replacement, options){\n    const search = typeof options === 'object' ?  Object.create(options) : {};\n    search.all = typeof search.all === 'boolean' ? search.all : false;\n\n    let result = domSearch(doc, pattern, options);\n\n    if(!result.length){\n        return doc;\n    }\n\n    if(isNode(replacement)){\n        replaceWithNode(result[0], pattern, replacement, search);\n        return doc;\n    }\n\n    replacement = String(replacement);\n\n    if(!search.all){\n        replaceWithText(result[0], pattern, replacement, search);\n        return doc;\n    }\n\n    for(let res of result){\n        replaceWithText(res, pattern, replacement, search);\n    }\n\n    return doc;\n}\n\n\n\nfunction replaceWithText(result, pattern, replacement, search){\n    let str = result.textNode.nodeValue;\n    let parts, collect = '';\n\n    if(search.all){\n        parts = str.split(pattern);\n    }else{\n        parts = str.split(pattern, 2);\n    }\n\n    for(let i=0; i<parts.length; i++){\n        collect += parts[i];\n        if(i < parts.length - 1){\n            collect += replacement;\n        }\n    }\n\n    result.textNode.nodeValue = collect;\n}\n\nfunction replaceWithNode(result, pattern, replacement, search){\n    let str = result.textNode.nodeValue;\n\n    let [before, after] = str.split(pattern, 2);\n\n    const frag = document.createDocumentFragment();\n\n    frag.appendChild(document.createTextNode(before));\n    frag.appendChild(replacement);\n    frag.appendChild(document.createTextNode(after));\n\n    result.parent.replaceChild(frag, result.textNode);\n\n}\n\nfunction isNode(o){\n  return (\n    typeof Node === \"object\" ? o instanceof Node :\n    o && typeof o === \"object\" && typeof o.nodeType === \"number\" && typeof o.nodeName===\"string\"\n  );\n}\n\n\nexport default domSearchReplace;\n\n/*\ngit remote add origin https://github.com/hollowdoor/dom_search_replace.git\ngit push -u origin master\n*/\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,SAAS,gBAAT,CAA0B,GAA1B,EAA+B,OAA/B,EAAwC,WAAxC,EAAqD,OAArD,EAA6D;QACnD,SAAS,QAAO,OAAP,yCAAO,OAAP,OAAmB,QAAnB,GAA+B,OAAO,MAAP,CAAc,OAAd,CAA/B,GAAwD,EAAvE;WACO,GAAP,GAAa,OAAO,OAAO,GAAd,KAAsB,SAAtB,GAAkC,OAAO,GAAzC,GAA+C,KAA5D;;QAEI,SAAS,UAAU,GAAV,EAAe,OAAf,EAAwB,OAAxB,CAAb;;QAEG,CAAC,OAAO,MAAX,EAAkB;eACP,GAAP;;;QAGD,OAAO,WAAP,CAAH,EAAuB;wBACH,OAAO,CAAP,CAAhB,EAA2B,OAA3B,EAAoC,WAApC,EAAiD,MAAjD;eACO,GAAP;;;kBAGU,OAAO,WAAP,CAAd;;QAEG,CAAC,OAAO,GAAX,EAAe;wBACK,OAAO,CAAP,CAAhB,EAA2B,OAA3B,EAAoC,WAApC,EAAiD,MAAjD;eACO,GAAP;;;;;;;;6BAGW,MAAf,8HAAsB;gBAAd,GAAc;;4BACF,GAAhB,EAAqB,OAArB,EAA8B,WAA9B,EAA2C,MAA3C;;;;;;;;;;;;;;;;;WAGG,GAAP;;;AAKJ,SAAS,eAAT,CAAyB,MAAzB,EAAiC,OAAjC,EAA0C,WAA1C,EAAuD,MAAvD,EAA8D;QACtD,MAAM,OAAO,QAAP,CAAgB,SAA1B;QACI,cAAJ;QAAW,UAAU,EAArB;;QAEG,OAAO,GAAV,EAAc;gBACF,IAAI,KAAJ,CAAU,OAAV,CAAR;KADJ,MAEK;gBACO,IAAI,KAAJ,CAAU,OAAV,EAAmB,CAAnB,CAAR;;;SAGA,IAAI,IAAE,CAAV,EAAa,IAAE,MAAM,MAArB,EAA6B,GAA7B,EAAiC;mBAClB,MAAM,CAAN,CAAX;YACG,IAAI,MAAM,MAAN,GAAe,CAAtB,EAAwB;uBACT,WAAX;;;;WAID,QAAP,CAAgB,SAAhB,GAA4B,OAA5B;;;AAGJ,SAAS,eAAT,CAAyB,MAAzB,EAAiC,OAAjC,EAA0C,WAA1C,EAAuD,MAAvD,EAA8D;QACtD,MAAM,OAAO,QAAP,CAAgB,SAA1B;;qBAEsB,IAAI,KAAJ,CAAU,OAAV,EAAmB,CAAnB,CAHoC;;;;QAGrD,MAHqD;QAG7C,KAH6C;;;QAKpD,OAAO,SAAS,sBAAT,EAAb;;SAEK,WAAL,CAAiB,SAAS,cAAT,CAAwB,MAAxB,CAAjB;SACK,WAAL,CAAiB,WAAjB;SACK,WAAL,CAAiB,SAAS,cAAT,CAAwB,KAAxB,CAAjB;;WAEO,MAAP,CAAc,YAAd,CAA2B,IAA3B,EAAiC,OAAO,QAAxC;;;AAIJ,SAAS,MAAT,CAAgB,CAAhB,EAAkB;WAEd,QAAO,IAAP,yCAAO,IAAP,OAAgB,QAAhB,GAA2B,aAAa,IAAxC,GACA,KAAK,QAAO,CAAP,yCAAO,CAAP,OAAa,QAAlB,IAA8B,OAAO,EAAE,QAAT,KAAsB,QAApD,IAAgE,OAAO,EAAE,QAAT,KAAoB,QAFtF;CAOF,AAEA;;"}